---
title: YOLO算法简介
date: 2022-08-19 13:01:25
tags: 深度学习
categories: 深度学习
cover: /images/文章图片/YOLO/yolo2.jpg
excerpt: YOLO算法，介绍其基本原理及实现细节，并用python实现。
--- 

{% image /images/文章图片/YOLO/yolo2.jpg %}

###  YOLO框架如何运作

#### YOLO用于检测给定图像中的对象的处理步骤

- 首先，输入图像：

{% image /images/文章图片/YOLO/005.png %}

- 然后，YOLO将输入图像划分为网格形式（例如3 X 3）：

{% image /images/文章图片/YOLO/006.png %}

- 最后，对每个网格应用图像分类和定位处理，获得预测对象的边界框及其对应的类概率。


整个过程是不是很清晰，下面逐一详细介绍。首先需要将标记数据传递给模型以进行训练。假设已将图像划分为大小为3 X 3的网格，且总共只有3个类别，分别是行人（c1）、汽车（c2）和摩托车（c3）。因此，对于每个单元格，标签y将是一个八维向量：

{% image /images/文章图片/YOLO/007.png %}

其中：
- pc定义对象是否存在于网格中（存在的概率）；
- bx、by、bh、bw指定边界框；
- c1、c2、c3代表类别。如果检测对象是汽车，则c2位置处的值将为1，c1和c3处的值将为0；

假设从上面的例子中选择第一个网格：

{% image /images/文章图片/YOLO/008.png %}

由于此网格中没有对象，因此pc将为零，此网格的y标签将为：

{% image /images/文章图片/YOLO/009.png %}

？意味着其它值是什么并不重要，因为网格中没有对象。下面举例另一个有车的网格（c2=1）：

{% image /images/文章图片/YOLO/010.png %}

在为此网格编写y标签之前，首先要了解YOLO如何确定网格中是否存在实际对象。大图中有两个物体（两辆车），因此YOLO将取这两个物体的中心点，物体将被分配到包含这些物体中心的网格中。中心点左侧网格的y标签会是这样的：

{% image /images/文章图片/YOLO/011.png %}

由于此网格中存在对象，因此pc将等于1，bx、by、bh、bw将相对于正在处理的特定网格单元计算。由于检测出的对象是汽车，所以c2=1，c1和c3均为0。对于9个网格中的每一个单元格，都具有八维输出向量。最终的输出形状为3X3X8。

使用上面的例子（输入图像：100X100X3，输出：3X3X8），模型将按如下方式进行训练：

{% image /images/文章图片/YOLO/012.png %}

使用经典的CNN网络构建模型，并进行模型训练。在测试阶段，将图像传递给模型，经过一次前向传播就得到输出y。为了简单起见，使用3X3网格解释这一点，但通常在实际场景中会采用更大的网格（比如19X19）。

即使一个对象跨越多个网格，它也只会被分配到其中点所在的单个网格。可以通过增加更多网格来减少多个对象出现在同一网格单元中的几率。

#### 如何编码边界框

如前所述，bx、by、bh和bw是相对于正在处理的网格单元计算而言的。下面通过一个例子来说明这一点。以包含汽车的右边网格为例：

{% image /images/文章图片/YOLO/013.png %}

由于bx、by、bh和bw将仅相对于该网格计算。此网格的y标签将为：

{% image /images/文章图片/YOLO/014.png %}

由于这个网格中有一个对象汽车，所以pc=1、c2=1。现在，看看如何决定bx、by、bh和bw的取值。在YOLO中，分配给所有网格的坐标都如下图所示：

{% image /images/文章图片/YOLO/015.png %}

bx、by是对象相对于该网格的中心点的x和y坐标。在例子中，近似bx=0.4和by=0.3：

{% image /images/文章图片/YOLO/016.png %}

bh是边界框的高度与相应单元网格的高度之比，在例子中约为0.9：bh=0.9，bw是边界框的宽度与网格单元的宽度之比，bw=0.5。此网格的y标签将为：

{% image /images/文章图片/YOLO/017.png %}

请注意，bx和by将始终介于0和1之间，因为中心点始终位于网格内，而在边界框的尺寸大于网格尺寸的情况下，bh和bw可以大于1。

#### 非极大值抑制|Non-Max Suppression

这里有一些思考的问题——如何判断预测的边界框是否是一个好结果（或一个坏结果）？单元格之间的交叉点，计算实际边界框和预测的边界框的并集交集。假设汽车的实际和预测边界框如下所示：

{% image /images/文章图片/YOLO/018.png %}

其中，红色框是实际的边界框，蓝色框是预测的边界框。如何判断它是否是一个好的预测呢？IoU将计算这两个框的并集交叉区域：

{% image /images/文章图片/YOLO/019.png %}

- IoU =交叉面积/联合的面积；
- 在本例中：IoU =黄色面积/绿色面积；








---
title: YOLO算法
date: 2022-08-19 13:01:25
tags: 深度学习
categories: 深度学习
cover: /images/文章图片/YOLO/001.jpg
excerpt: 计算机视觉：YOLO算法
--- 

{% image /images/文章图片/YOLO/001.jpg %}

### 为什么使用YOLO算法

深度学习相关的目标检测方法大致可以分为两派：
1.基于区域提名的：如R-CNN，SPP-Net，Fast R-CNN，Faster R-CNN，R-FCN；
2.端到端（End-to-End）：无需区域提名的，如YOLO，SSD

目前来说，RCNN系列基于区域提名的算法面临一个问题，不是端到端的模型，几个构件拼凑在一起组成整个检测系统，操作起来比较复杂耗时较长，但端到端的YOLO算法速度上优势明显，该方法操作简便且仿真速度快，效果也不差。


### YOLO算法是什么？

YOLO算法（You Only Look Once）与RCNN系列算法不一样，是以不同的方式处理对象检测。它将整个图像放在一个实例中，并预测这些框的边界框坐标和及所属类别概率。使用YOLO算法最大优的点是速度极快，每秒可处理45帧，也能够理解一般的对象表示。所以YOLO算法在自动驾驶汽车等前沿技术中使用的实时对象检测中很受欢迎。


### 实时的重要性

人们看到图像以后，可以立即识别其中的对象、它们的位置和相对位置。这使得我们能够在几乎无意识的情况下完成复杂的任务，比如开车。因此，对汽车进行自动驾驶训练需要类似水平的反应能力和准确性。在其最基本的形式中，这样的系统必须能够分析实时视频中的道路，并能够在继续确定路径之前检测各种类型的对象及其在现实世界中的位置，所有这些都必须是实时的。

先前的检测系统使用分类器对测试图像的不同切片进行评估。例如，Deformable Parts Model (DPM)涉及到在图像中均匀间隔的位置上滑动窗口并在这些部件上运行分类器。R-CNN(Region-based Convolutional Neural Networks)是另一种模型，它运行一种分割算法将一幅图像分割成一个个小块，然后在这些小块上运行一个分类器。但是，速度慢、优化困难一直困扰着这种YOLO之前的系统。

### YOLO算法简介

YOLO将对象检测重新定义为一个回归问题。它将单个卷积神经网络(CNN)应用于整个图像，将图像分成网格，并预测每个网格的类概率和边界框。例如，以一个100x100的图像为例。我们把它分成网格，比如7x7。


{% image /images/文章图片/YOLO/002.jpeg %}


然后，对于每个网格，网络都会预测一个边界框和与每个类别（汽车，行人，交通信号灯等）相对应的概率。

{% image /images/文章图片/YOLO/003.jpeg %}

每个边界框可以使用四个描述符进行描述：
* 


































#### 1.2.1 YOLO
YOLO的全拼是You Only Look Once，顾名思义就是只看一次，进一步把目标判定和目标识别合二为一，所以识别的性能有了很大的提升，达到每秒45帧，而在快速版的YOLO（Fast YOLO，卷积层更少）中，可以达到每秒155帧。

针对一张图片，YOLO的处理步骤为：
1.把输入图片缩放到448*448大小
2.运行卷积网络；
3.对模型置信度卡阈值，得到目标位置和类别

YOLO将448*448大小的图切成S*S的网格，目标中心点所在的搁置负责该目标的相关检测，每个网络预测B个边框及其置信度，以及C种类别的概率。YOLO中S = 7 ，B = 2，C取决于数据集中物体类别数量，比如VOC数据集就是C = 20，对于VOC数据集来说，YOLO就是把图片统一缩放到448*448，然后每张图片平均划分为7*7=49个小格子，每个格子预测2个矩形框及其置信度，以及20中类别的概率。

YOLO简化了真个目标检测的流程，速度提升也很大，但是YOLO还是有不少可以改进的地方，比如S*S的网格就是一个比较启发式的策略，如果两个小目标同时落入一个格子中，模型也只能预测一个；另一个问题是Loss函数对不同大小的bbox未做区分。

#### 1.2.2 SSD
SSD的全拼是Single Shot MultiBox Detector，冲着YOLO的缺点来的。SSD的网络分为两部分，前面是用于图像分类的标准网络，后面的网络是用于检测的多尺度特征映射层，从而达到检测不同大小的目标，SSD在保持YOLO高速的同时效果也提升了很多，主要是借鉴了Faster R-CNN中的Anchor机制，同时使用了多尺度。但是从原理依然可以看出，Default Box的新装以及网格大小是事先固定的，那么对特定图片小目标的提取会不够好。
